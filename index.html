<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="theme-color" content="#0B071A" />
    
    <!-- SEO e Metatags -->
    <title>fillshy - Autonomous AI Content Pipeline</title>
    <meta name="description" content="Generate diverse content 24/7 with AI and save it directly to your GitHub repository." />
    <!-- ... (outras metatags) ... -->

    <!-- Otimizações de rede -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <link rel="preconnect" href="https://unpkg.com">
    <link rel="preconnect" href="https://esm.sh">

    <!-- Carregamento de fontes não-bloqueante -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;900&family=Sora:wght@600;700&display=swap" media="print" onload="this.media='all'">
    <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;900&family=Sora:wght@600;700&display=swap"></noscript>
    
    <!-- (NOVO!) CSS para o Loader Imediato -->
    <!-- Replicamos a animação da logo aqui para que ela apareça instantaneamente -->
    <style>
      /* Estilos para centralizar o loader */
      #app-loader {
        display: flex;
        align-items: center;
        justify-content: center;
        min-height: 100vh;
        width: 100%;
      }
      /* Estilos da logo */
      .loader-logo {
        display: flex;
        gap: 0.5rem; /* 8px, equivalente a gap-2 do Tailwind */
        align-items: center;
      }
      /* Estilos das barras da logo */
      .loader-bar {
        width: 0.5rem; /* 8px, w-2 */
        height: 2.5rem; /* 40px, h-10 */
        background-color: #6366F1; /* indigo-500, um exemplo */
        border-radius: 0.25rem; /* rounded-sm */
      }
      /* Aplica as animações */
      .loader-bar-1 {
        animation: logo-bar-1 0.8s cubic-bezier(0.215, 0.61, 0.355, 1) forwards;
      }
      .loader-bar-2 {
        animation: logo-bar-2 0.8s cubic-bezier(0.215, 0.61, 0.355, 1) forwards;
      }
      /* Keyframes da sua configuração do Tailwind, convertidos para CSS puro */
      @keyframes logo-bar-1 {
        from { transform: translateY(-40px); opacity: 0; }
        to { transform: translateY(0); opacity: 1; }
      }
      @keyframes logo-bar-2 {
        from { transform: translateY(40px); opacity: 0; }
        to { transform: translateY(0); opacity: 1; }
      }
    </style>

    <!--
      ORDEM DE SCRIPTS MANTIDA:
      - Tailwind pode ser 'defer' pois é independente.
      - Babel NÃO PODE ser 'defer' pois nosso script principal depende dele.
    -->
    <script src="https://cdn.tailwindcss.com" defer></script>
    <script src="https://unpkg.com/@babel/standalone@7.24.7/babel.min.js"></script>

    <!-- Config do Tailwind e Import Map (Sem alterações) -->
    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: { sans: ['Inter','sans-serif'], heading: ['Sora','sans-serif'] },
            keyframes: { 'reveal-word':{from:{opacity:'0',transform:'translateY(10px)'},to:{opacity:'1',transform:'translateY(0)'}}, 'letter-reveal':{'0%':{opacity:0,transform:'translateY(20px) scale(0.8)'},'100%':{opacity:1,transform:'translateY(0) scale(1)'}}, 'logo-bar-1':{'0%':{transform:'translateY(-40px)',opacity:0},'100%':{transform:'translateY(0)',opacity:1}}, 'logo-bar-2':{'0%':{transform:'translateY(40px)',opacity:0},'100%':{transform:'translateY(0)',opacity:1}}, 'blob-animation':{'0%':{transform:'translate(0px, 0px) scale(1)'},'33%':{transform:'translate(30px, -50px) scale(1.1)'},'66%':{transform:'translate(-20px, 20px) scale(0.9)'},'100%':{transform:'translate(0px, 0px) scale(1)'}}, 'fade-in':{from:{opacity:0},to:{opacity:1}} },
            animation: { 'reveal-word':'reveal-word 0.5s cubic-bezier(0.215, 0.61, 0.355, 1) forwards', 'letter-reveal':'letter-reveal 0.6s cubic-bezier(0.215, 0.61, 0.355, 1) forwards', 'logo-bar-1':'logo-bar-1 0.8s cubic-bezier(0.215, 0.61, 0.355, 1) forwards', 'logo-bar-2':'logo-bar-2 0.8s cubic-bezier(0.215, 0.61, 0.355, 1) forwards', 'blob':'blob-animation 20s infinite ease-in-out', 'fade-in':'fade-in 0.3s ease-in-out' }
          }
        },
        plugins: [ function({addUtilities}){addUtilities({'.scrollbar-hide':{'-ms-overflow-style':'none','scrollbar-width':'none','&::-webkit-scrollbar':{display:'none'}}})} ]
      }
    </script>
    <script type="importmap">
    {
      "imports": {
        "react": "https://esm.sh/react@18.2.0",
        "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
        "react/jsx-runtime": "https://esm.sh/react@18.2.0/jsx-runtime",
        "@google/genai": "https://esm.sh/@google/genai@0.14.0"
      }
    }
    </script>
</head>
<body class="bg-[#0B071A] text-[#E0DDF0] font-sans">
    <noscript>Você precisa habilitar o JavaScript para rodar esta aplicação.</noscript>
    
    <!-- O contêiner da sua aplicação React -->
    <div id="root">
        <!-- (NOVO!) Loader em HTML puro que é exibido IMEDIATAMENTE -->
        <!-- O React irá substituir este conteúdo quando estiver pronto -->
        <div id="app-loader">
          <div class="loader-logo">
            <div class="loader-bar loader-bar-1"></div>
            <div class="loader-bar loader-bar-2"></div>
          </div>
        </div>
    </div>

    <!-- Script principal (a lógica interna está correta) -->
    <script type="module">
        const blobCache = new Map();

        async function loadSource(path, parentUrl) {
            const baseUrl = new URL(path, parentUrl).href;
            if (/\.(tsx?|jsx?)($|\?)/.test(baseUrl)) {
                const res = await fetch(baseUrl);
                if (!res.ok) throw new Error('Não foi possível carregar ' + baseUrl);
                return { absoluteUrl: baseUrl, sourceCode: await res.text() };
            }
            const base = baseUrl.replace(/\/$/, '');
            const candidates = [ base + '.tsx', base + '.ts', base + '/index.tsx', base + '/index.ts' ];
            for (const url of candidates) {
                try {
                    const res = await fetch(url);
                    if (res.ok) return { absoluteUrl: url, sourceCode: await res.text() };
                } catch (_) {}
            }
            throw new Error('Não foi possível encontrar o arquivo para ' + baseUrl);
        }

        async function resolveAndTranspile(entryPath, parentUrl = window.location.href) {
            const { absoluteUrl, sourceCode } = await loadSource(entryPath, parentUrl);
            if (blobCache.has(absoluteUrl)) return blobCache.get(absoluteUrl);
            const importRegex = /\bimport\s+[^'"]*['"](.*?)['"]/g;
            const dependencies = new Map();
            let match;
            while ((match = importRegex.exec(sourceCode)) !== null) {
                if (match[1].startsWith('.')) dependencies.set(match[1], null);
            }
            await Promise.all(
                Array.from(dependencies.keys()).map(async (depPath) => {
                    const childBlobUrl = await resolveAndTranspile(depPath, absoluteUrl);
                    dependencies.set(depPath, childBlobUrl);
                })
            );
            let transformedCode = sourceCode;
            for (const [originalPath, blobUrl] of dependencies.entries()) {
                transformedCode = transformedCode.replace(new RegExp(`(['"])${originalPath}\\1`, 'g'), `$1${blobUrl}$1`);
            }
            const { code } = Babel.transform(transformedCode, {
                presets: [['react',{runtime:'automatic'}],['typescript',{allExtensions:true,isTSX:true}]],
                sourceType: 'module',
                filename: absoluteUrl
            });
            const blobUrl = URL.createObjectURL(new Blob([code],{type:'application/javascript'}));
            blobCache.set(absoluteUrl, blobUrl);
            return blobUrl;
        }

        (async () => {
            const rootEl = document.getElementById('root');
            try {
                const entryModuleUrl = await resolveAndTranspile('/index.tsx');
                await import(entryModuleUrl);
            } catch (error) {
                console.error('Falha ao inicializar a aplicação:', error);
                // (REMOVIDO!) a alteração do `finally`
                rootEl.innerHTML = `<div style="color:#ff8b8b; background:#2b0f0f; padding:20px; border-radius:8px; font-family:monospace; white-space:pre-wrap;"><h2>Erro na Aplicação</h2><p>${error.message}</p></div>`;
            }
            // A "mágica" agora é que não precisamos fazer NADA.
            // O próprio React, ao ser renderizado pelo seu `index.tsx`,
            // irá limpar o div#root e colocar a sua aplicação no lugar do loader.
        })();
    </script>
</body>
</html>
